<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How Mental Health Was Affected (1990 to 2024)</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        .bar {
            fill: plum;
            transition: fill 0.2s;
            cursor: pointer;
        }

        .bar:hover {
            fill: lightblue;
        }

        .tooltip {
            position: absolute;
            background: lightyellow;
            border: 1px solid #ccc;
            padding: 5px;
            font-size: 12px;
            display: none;
            pointer-events: none;
        }

        .chart-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px;
        }

        .pie-chart-container {
            margin-top: 30px;
        }
    </style>
</head>

<body>
    <h1>How Mental Health Was Affected (1990 to 2024)</h1>

    <!-- Bar Chart -->
    <div class="chart-container">
        <svg id="chart" width="600" height="400"></svg>
    </div>

    <!-- Pie Chart -->
    <div class="pie-chart-container">
        <svg id="pieChart" width="400" height="400"></svg>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        // Data for the chart
        const data = [
            { year: 1990, individuals: 350000000, info: "In 1990, an estimated 350 million people worldwide were affected by mental health disorders, including depression, anxiety, and schizophrenia. Mental health awareness was low, leading to stigma and inadequate access to care." },
            { year: 2001, individuals: 450000000, info: "By 2001, the number had risen to 450 million. Increased awareness and better diagnostic tools contributed to the rise, but stigma and lack of resources remained key challenges." },
            { year: 2010, individuals: 450000000, info: "In 2010, mental health disorders continued to affect 450 million people worldwide. Digital mental health tools started emerging, providing new ways to support those in need." },
            { year: 2020, individuals: 100000000, info: "In 2020, around 100 million people were affected by mental health disorders. The COVID-19 pandemic had a major impact, increasing rates of anxiety and depression globally." },
            { year: 2025, individuals: 100000000, info: "As of 2024, an estimated 100 million people continue to struggle with mental health issues. Ongoing effects of the pandemic and increased awareness contribute to this figure. The number is expected to grow due to factors like social stressors and economic instability." }
        ];

        const svg = d3.select("#chart");
        const pieSvg = d3.select("#pieChart");
        const tooltip = d3.select("#tooltip");
        const width = +svg.attr("width");
        const height = +svg.attr("height");
        const radius = Math.min(400, 400) / 2;

        // Set up scales for the bar chart
        const x = d3.scaleBand()
            .domain(data.map(d => d.year))
            .range([0, width])
            .padding(0.1);

        const y = d3.scaleLinear()
            .domain([0, d3.max(data, d => d.individuals)])
            .range([height - 20, 20]);

        // Create Bar Chart
        svg.selectAll(".bar")
            .data(data)
            .enter().append("rect")
            .attr("class", "bar")
            .attr("x", d => x(d.year))
            .attr("y", d => y(d.individuals))
            .attr("width", x.bandwidth())
            .attr("height", d => height - y(d.individuals) - 20)
            .on("mouseover", (event, d) => {
                tooltip.style("display", "block")
                    .html(`Year: ${d.year}<br>Individuals: ${d.individuals / 1000000}M`) 
                    .style("left", (event.pageX + 10) + "px")
                    .style("top", (event.pageY + 10) + "px");
            })
            .on("mouseout", () => tooltip.style("display", "none"))
            .on("click", (event, d) => {
                window.location.href = `details.html?year=${d.year}&info=${encodeURIComponent(d.info)}`;
            });

        // Create Pie Chart
        const pie = d3.pie().value(d => d.individuals);
        const arc = d3.arc().outerRadius(radius).innerRadius(0);

        const pieGroup = pieSvg.append("g")
            .attr("transform", `translate(${400 / 2},${400 / 2})`);

        pieGroup.selectAll(".arc")
            .data(pie(data))
            .enter().append("path")
            .attr("class", "arc")
            .attr("d", arc)
            .attr("fill", (d, i) => d3.schemeCategory10[i])
            .on("mouseover", (event, d) => {
                tooltip.style("display", "block")
                    .html(`Year: ${d.data.year}<br>Individuals: ${d.data.individuals / 1000000}M`)
                    .style("left", (event.pageX + 10) + "px")
                    .style("top", (event.pageY + 10) + "px");
            })
            .on("mouseout", () => tooltip.style("display", "none"))
            .on("click", (event, d) => {
                window.location.href = `details.html?year=${d.data.year}&info=${encodeURIComponent(d.data.info)}`;
            });
    </script>
</body>
</html>